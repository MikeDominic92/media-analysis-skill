### PHASE 7: FILE ORGANIZATION & ARCHIVING (Documentation Specialist Agent)

**Automatic file organization after ticket resolution with Phase 0 artifact archival:**

**Step 0: Collect Phase 0 Artifacts (NEW)**

Before organizing resolution files, collect all Phase 0 analysis artifacts:

**From processing/[ticket-folder]/:**
- `metadata.json` - Pre-extracted metadata from Gemini/OCR
- `preliminary_analysis.md` - Initial analysis report
- Original ticket file (PDF, image, audio, video)

**Why Archive Phase 0 Data:**
- [+] **Audit trail:** Shows extraction accuracy over time
- [+] **Knowledge base:** Builds dataset for future training
- [+] **Quality metrics:** Tracks confidence scores and accuracy
- [+] **Debugging:** Helps troubleshoot extraction failures
- [+] **Continuous improvement:** Identifies patterns for optimization

**Step 1: Create Complete Resolution Package**

Create enhanced folder structure with Phase 0 artifacts:

```bash
# Create resolution folder with subdirectories
WEBEDI_ID="[WebEDI-ID]"
COMPANY_NAME="[Company_Name]"
TICKET_ID="[ticket-id]"

RESOLUTION_DIR="C:\Users\sleep\Documents\tickets\resolution\${WEBEDI_ID}_${COMPANY_NAME}"

mkdir -p "$RESOLUTION_DIR"/{ticket_original,analysis,customer_response,verification}
```

**Enhanced Directory Structure:**
```
resolution/[WebEDI-ID]_[Company_Name]/
├── ticket_original/
│   ├── [original_filename].pdf
│   └── metadata.json (Phase 0 output)
├── analysis/
│   ├── preliminary_analysis.md (Phase 0 output)
│   ├── investigation_report.md (Phase 3-5 output)
│   └── notebooklm_citations.md (Phase 3-5 output)
├── customer_response/
│   ├── response_draft.md
│   └── response_final.md
├── verification/
│   ├── qa_checklist.md (Phase 8 output)
│   └── sign_off.md (Phase 8 output)
├── resolution_summary.md (Generated by archival.py)
└── phase0_metrics.json (Generated by archival.py)
```

**Step 2: Archive Using Automated Script (RECOMMENDED)**

Use archival.py for complete automated archival:

```bash
cd "C:\Users\sleep\.claude\skills\media-analysis"
python archival.py [ticket-id] [WebEDI-ID] "[Company_Name]"
```

**Example:**
```bash
python archival.py 13624970 WEB-456 "Ace Hardware"
```

**What archival.py does automatically:**
- [+] Creates complete folder structure
- [+] Copies Phase 0 artifacts (metadata.json, preliminary_analysis.md)
- [+] Copies original ticket files (PDF, images, audio, video)
- [+] Generates resolution_summary.md with timeline and metrics
- [+] Generates phase0_metrics.json for performance tracking
- [+] Reports success with full path

**Step 3: Manual Archival (If archival.py not available)**

```bash
# Copy Phase 0 artifacts
cp "C:\Users\sleep\Documents\tickets\processing\${TICKET_ID}\metadata.json" \
   "$RESOLUTION_DIR\ticket_original\"

cp "C:\Users\sleep\Documents\tickets\processing\${TICKET_ID}\preliminary_analysis.md" \
   "$RESOLUTION_DIR\analysis\"

# Copy original ticket file
cp "C:\Users\sleep\Documents\tickets\processing\${TICKET_ID}\*.pdf" \
   "$RESOLUTION_DIR\ticket_original\"

# Move ticket from incoming (if not in processing)
mv "C:\Users\sleep\Documents\tickets\incoming\[ticket-id]_[company].pdf" \
   "$RESOLUTION_DIR\ticket_original\ticket_[ticket-id].pdf"

# Move audio (if exists)
mv "C:\Users\sleep\Documents\tickets\incoming\recording_[ticket-id].mp3" \
   "$RESOLUTION_DIR\ticket_original\audio_[ticket-id].mp3"

# Move screenshots (if exist)
mv "C:\Users\sleep\Documents\tickets\incoming\screenshot_[ticket-id]_*.png" \
   "$RESOLUTION_DIR\ticket_original\"
```

**Step 4: Save Investigation Report**
```bash
# Save Investigation PRD as investigation_[ticket-id].md
Write: "$RESOLUTION_DIR\analysis\investigation_[ticket-id].md"
```

**Step 5: Save Customer Response**
```bash
# Save customer response as response_[ticket-id].md
Write: "$RESOLUTION_DIR\customer_response\response_[ticket-id].md"
```

**Step 6: Generate Resolution Summary (if manual archival)**

Create `resolution_summary.md`:

```markdown
# Resolution Summary - Ticket [ID]

## Timeline
- **Received:** [timestamp]
- **Phase 0 Complete:** [timestamp] (+2 minutes)
- **Investigation Complete:** [timestamp]
- **Resolution Delivered:** [timestamp]
- **Total Time:** [duration]

## Phase 0 Analysis Results
- **Extraction Method:** Gemini 2.5 Pro / OCR
- **Confidence Score:** [0.XX] (HIGH/MEDIUM/LOW)
- **Accuracy:** [XX]% (verified by Analyst)
- **Time Saved:** ~3 minutes (vs manual extraction)

## Investigation Results
- **NotebookLM Queries:** [X]
- **Knowledge Base Sources:** [X]
- **Root Cause:** [summary]
- **Solution:** [summary]

## Customer Impact
- **Severity:** [CRITICAL/HIGH/MEDIUM/LOW]
- **Resolution Time:** [X minutes]
- **Customer Satisfaction:** [X/5] (if available)

## Quality Metrics
- **Extraction Accuracy:** [XX]%
- **NotebookLM Confidence:** [0.XX]
- **Solution Verified:** [Yes/No]
- **QA Sign-Off:** [Yes/No]
```

**Step 7: Generate Phase 0 Metrics (if manual archival)**

Create `phase0_metrics.json`:

```json
{
  "ticket_id": "[ID]",
  "phase0_timestamp": "[ISO timestamp]",
  "extraction_method": "gemini|ocr|hybrid",
  "confidence_score": 0.XX,
  "processing_time_seconds": 45,
  "file_type": "pdf|image|audio|video",
  "metadata_fields_extracted": XX,
  "metadata_fields_verified": XX,
  "accuracy_percentage": XX,
  "ocr_fallback_used": false,
  "errors": [],
  "archived_at": "[ISO timestamp]"
}
```

**Step 8: Update Customer History**

Create or update: `customers/[WebEDI-ID]_[Company_Name].md`

```markdown
# Customer History: [Company Name]

**WebEDI ID**: [ID]
**Company Name**: [Full Name]
**Created**: [YYYY-MM-DD]
**Last Updated**: [YYYY-MM-DD]

---

## Primary Contacts

| Name | Role | Phone | Email |
|------|------|-------|-------|
| [Contact 1] | [Role] | [Phone] | [Email] |

---

## Trading Partners

| Partner | Transaction Types | Integration | Status |
|---------|------------------|-------------|--------|
| [Partner 1] | 850, 856, 810 | WebEDI | Active |

---

## Integration Details

**Current Integrations**:
- WebEDI Portal: [Active/Inactive]
- GlobalShop: [Active/Inactive/Defunct]
- NetSuite: [Active/Inactive/Defunct]
- QuickBooks: [Active/Inactive/Defunct]

---

## Issue History

### Ticket #[ID] - [YYYY-MM-DD]
**Status**: [Resolved/In Progress/Escalated]
**Scale**: [L0/L1/L2/L3/L4]
**Complexity**: [Score 0-8]

**Summary**: [Brief description]
**Root Cause**: [Technical summary]
**Resolution**: [What was done]
**Time**: [Investigation time: Xs]

**Phase 0 Analysis:**
- **Extraction Method:** [Gemini/OCR/Hybrid]
- **Confidence:** [0.XX]
- **Time Saved:** ~3 minutes

**Documents**:
- Phase 0 Metadata: resolution/[folder]/ticket_original/metadata.json
- Phase 0 Analysis: resolution/[folder]/analysis/preliminary_analysis.md
- Investigation PRD: resolution/[folder]/analysis/investigation_[id].md
- Customer Response: resolution/[folder]/customer_response/response_[id].md
- Resolution Summary: resolution/[folder]/resolution_summary.md
- Phase 0 Metrics: resolution/[folder]/phase0_metrics.json

**Patterns Identified**:
- [Pattern 1]

**Lessons Learned**:
- [Lesson 1]

---

## Recurring Patterns

| Pattern | Occurrences | Last Seen | Trading Partner |
|---------|-------------|-----------|-----------------|
| [Pattern 1] | [Count] | [Date] | [Partner] |

---

## Notes & Observations

[Any relevant notes about customer, integrations, preferences, etc.]

---

## Follow-Up Items

- [ ] [Follow-up item 1]
- [ ] [Follow-up item 2]

---

## Recommended Actions

[Any proactive recommendations based on history]
```

**Step 9: Update Customer Index**

Update: `customers/CUSTOMER_INDEX.md`

```markdown
# Customer Index

**Last Updated**: [YYYY-MM-DD]
**Total Customers**: [Count]
**Active Investigations**: [Count]

---

## Quick Reference

| WebEDI ID | Company Name | Last Ticket | Tickets (30d) | Priority |
|-----------|--------------|-------------|---------------|----------|
| [ID] | [Name] | [Date] | [Count] | [Low/Med/High] |

---

## Recent Activity (Last 30 Days)

- [YYYY-MM-DD]: Ticket #[ID] - [Company] - [Issue] - [Status]

---

## High-Priority Customers (3+ Tickets in 30 Days)

| Company | Tickets | Common Issue | Action Needed |
|---------|---------|--------------|---------------|
| [Name] | [Count] | [Pattern] | [Action] |

---

## Common Issue Patterns

| Pattern | Affected Customers | Trading Partners | Resolution |
|---------|-------------------|------------------|------------|
| [Pattern] | [Count] | [Partners] | [Solution] |
```

**Step 10: Verification Checklist**

- [ ] Customer folder created/verified
- [ ] Phase 0 artifacts archived (metadata.json, preliminary_analysis.md)
- [ ] Original ticket file(s) archived (PDF, images, audio, video)
- [ ] Resolution summary generated
- [ ] Phase 0 metrics generated
- [ ] Investigation report saved
- [ ] Customer response saved
- [ ] Customer history updated (including Phase 0 data)
- [ ] Customer index updated
- [ ] Incoming folder cleaned (files removed)
- [ ] Processing folder cleaned (files removed/archived)

**Benefits of Phase 0 Archival:**

1. **Complete Audit Trail** - Track extraction accuracy over time
2. **Knowledge Base Growth** - Build dataset for training improvements
3. **Quality Metrics** - Monitor automation effectiveness
4. **Continuous Improvement** - Identify areas for enhancement
5. **Pattern Recognition** - Analyze ticket types and extraction methods
6. **Debugging** - Troubleshoot extraction failures systematically

**Reference:** See `C:\Users\sleep\.claude\skills\media-analysis\ARCHIVAL_GUIDE.md` for complete documentation.

---
